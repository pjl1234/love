<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>è¿™é¡¿åƒå•¥-å²šç²¾çµ</title>
  <link type="text/css" href="css/index2.css" rel="stylesheet">
</head>
<body nload="top.resizeTo(300,200); top.moveBy(300,200)">
  <div class="wrapper">
  	<div class="tp"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
      <div class="pointer">å¼€å§‹</div>
    </div>
  </div>
  <div class="result"></div>
  <a href="yingdao.html"><div class="back">å›åˆ°ä¸»é¡µå“ŸğŸ’—</div></a>

<script>
  let getEle = document.getElementsByClassName.bind(document);
  let pointer = getEle('pointer')[0];
  let result = getEle('result')[0];
  let lights = Array.prototype.slice.call(getEle('light'));

  let onRotation = false; // è®°å½•å½“å‰æ˜¯å¦æ­£åœ¨æ—‹è½¬ï¼Œå¦‚æœæ­£åœ¨æ—‹è½¬ï¼Œå°±ä¸èƒ½ç»§ç»­ç‚¹å‡»äº†
  let reward = ['å†’èœ', 'ä¸€æ¥¼ç›’é¥­', 'é¢é¦†å°é¢', 'ä¸€æ¥¼æ‹Œé¥­', 'äºŒæ¥¼é£Ÿå ‚',
    'è‘±æ²¹æ‹Œé¢', 'å…ƒæ°”çƒ¤é¸­', 'ç‚¹å¤–å–', 'é¢é¦†ç›’é¥­', 'æ³¡é¢'];

  // æ ¹æ®éšæœºè§’åº¦è·å–å¥–åŠ±
  let getReward = (function() {
    currentDeg = 0;
    return function() {
      // è½¬ä¸‰åœˆåˆ°å››åœˆ
      let rotateDeg = Math.random() * 360 + 1080;
      currentDeg += rotateDeg;
      let rewardText = reward[Math.floor((currentDeg + 18) % 360 / 36)]
      return {
        deg: currentDeg,
        text: rewardText === 'è°¢è°¢å‚ä¸' ? 'å¾ˆé—æ†¾ï¼Œæ‚¨æ²¡æœ‰è·å¾—å¥–å“ã€‚' : 'å’±ä»¬åƒ: ' + rewardText
      }
    }
  })();

  pointer.addEventListener('click', () => {
    if (onRotation) return;
    console.log('å¼€å§‹æŠ½å¥–');
    onRotation = true;
    lights.forEach(light => { light.className += ' light-twinkling'; });
    let nextStatus = getReward();
    console.log(nextStatus)
    result.innerText = nextStatus.text;
    result.style.display = 'none';
    pointer.style.transform = `rotateZ(${nextStatus.deg}deg)`;
  })
  pointer.addEventListener('transitionend', () => {
    console.log('æŠ½å¥–ç»“æŸ');
    setTimeout(() => { // ç­‰é—ªçƒä¸‰ä¸‹ç»“æŸ
      onRotation = false;
      lights.forEach(light => { light.className = 'light'; });
      result.style.display = 'block';
    }, 300);
  })
</script>
</body>
</html>